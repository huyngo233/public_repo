/*! @name videojs-skin-nzherald @version 2.0.0 @license UNLICENSED */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsSkinNzherald=t(e.videojs)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e);const i=".skip-buttons-container",s=e=>{(e=>{const t=document.getElementById(e.id());t.querySelector(i)||t.querySelector("video").insertAdjacentHTML("afterend",`<div class="${i.replace(".","")}"><div class="row"></div></div>`);const[n,s,a]=[".vjs-skip-backward-button",".vjs-play-control",".vjs-skip-forward-button"].map((e=>t.querySelector(e))),l=t.querySelector(i+" .row"),[r,o,d]=[n,s,a].map((e=>e.parentNode.removeChild(e)));l.appendChild(r),l.appendChild(o),l.appendChild(d)})(e)},a="iris-slate-text-container",l="btnIrisNzhPlay",r="btnIrisNzhPlayProgress",o="lbNzhVideoDurationForImage",d="lbNzhVideoDurationForDescription",c="iris-nzh-play-button",u=(e,t)=>e.el().querySelector(`[id="${t}"]`),p=(e,t)=>e.el().querySelector(`.${t}`),h=(e,t)=>e.el().querySelector(`[id$="${t}"]`),v=(e,t)=>{const n=u(e,l);if((null==n?void 0:n.className)===`${c} active`){u(e,r).style.animationPlayState=t}},y=(e,t)=>{if(!t.length)return null;const n=h(e,"end-next-slate-title");return t.find((e=>e.title===(null==n?void 0:n.textContent)))},f=e=>{const t=p(e,a);null==t||t.appendChild(N())},m=e=>{const t=h(e,"end-next-slate-image");if(t){const e=E(o,"iris-nzh-video-duration-label-image");t.appendChild(e)}},g=e=>{const t=p(e,a);if(t){const e=E(d,"iris-nzh-video-duration-label-description");t.appendChild(e)}},b=(e,t)=>{const n=u(e,l);n&&(n.className=t)},N=()=>{const e=document.createElement("div");e.id=l,e.className=c;const t=document.createElement("div");t.className="btn",t.innerHTML='<svg width="10" height="14" viewBox="0 0 10 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M0 12.6142C0 13.0115 0.441073 13.2501 0.773625 13.0326L9.35997 7.41849C9.6618 7.22114 9.6618 6.77888 9.35996 6.58152L0.773624 0.967379C0.441072 0.749941 0 0.988536 0 1.38586V12.6142Z" fill="white"/>\n</svg><span>Play</span>',e.appendChild(t);const n=document.createElement("div");return n.id=r,n.className="progress",e.appendChild(n),e},E=(e,t)=>{const n=document.createElement("label");return n.id=e,n.className=t,n},w=e=>Math.floor(e/60)+":"+("0"+Math.floor(e%60)).slice(-2),x=n.default.getPlugin("plugin"),C={};class k extends x{constructor(e,t){super(e),this.upNextAssets=[],this.mutationObserverConfig={attributes:!0,attributeFilter:["class"]},this.observer=new MutationObserver(this.upNextElementChanged.bind(this)),this.options=n.default.mergeOptions(C,t);const i=this;this.player.ready((()=>{this.player.addClass("vjs-skin-nzherald"),this.player.on("play",(()=>{var e;const t=null==(e=document)?void 0:e.querySelectorAll(".video-js.vjs-touch-enabled");t&&0!==t.length&&s(this.player)})),this.player.on("playing",(()=>{setTimeout((()=>{i.irisUpNextSlateHandler(i)}),1e3),v(i.player,"running")})),this.player.on("ended",(()=>{this.handleVideoEndedEvent(this.player)})),this.player.on("pause",(()=>{v(this.player,"paused")})),window.addEventListener("iris_watch",(e=>{i.upNextAssets=e.detail}))}))}irisUpNextSlateHandler(e){var t;t=e.player,u(t,l)||f(t),u(t,o)||m(t),u(t,d)||g(t);const n=h(e.player,"end-next-slate");e.observer.observe(n,e.mutationObserverConfig),n.addEventListener("click",(()=>{e.handleVideoEndedEvent(e.player)}));const i=h(e.player,"skip_forward_button");null==i||i.addEventListener("click",(()=>{e.handleVideoEndedEvent(e.player)}));const s=h(e.player,"skip_backward_button");null==s||s.addEventListener("click",(()=>{e.handleVideoEndedEvent(e.player)}))}upNextElementChanged(e){const t=this;e.forEach((e=>{var n;"attributes"===e.type&&"class"===e.attributeName&&e.target.id.includes("end-next-slate")&&e.target.className.includes("show")&&(n=t.player,b(n,`${c} active`),((e,t)=>{const n=y(e,t);n&&e.catalog.getVideo(n.platform_id,((t,n)=>{if(!t||404!=t.status&&403!=t.status){const t=w(n.duration),i=u(e,o);i&&(i.innerHTML=t);const s=u(e,d);s&&(s.innerHTML=t)}else console.log("Video Not Found, skipping asset")}))})(t.player,t.upNextAssets),v(t.player,"running"))}))}handleVideoEndedEvent(e){(e=>{b(e,c)})(e),this.observer.disconnect()}}return k.defaultState={},k.VERSION="2.0.0",n.default.registerPlugin("skinNzherald",k),k}));
